FROM ubuntu:latest

RUN apt update && \
    apt install -y sudo

RUN sudo apt update && \
    sudo apt install -y software-properties-common && \
    sudo add-apt-repository -y ppa:ondrej/php && \
    sudo apt update && \
    sudo apt-get install -y \
    php \
    nginx \
    php-fpm \
    php-zip \
    php-gd \
    php-mbstring \
    php-curl \
    php-xml \
    php-bcmath \
    php-pgsql \
    git \
    curl

COPY --from=composer:latest /usr/bin/composer /usr/bin/composer

COPY docker/nginx /etc/nginx/

WORKDIR /var/www/html
COPY . .

RUN chmod +x ./entrypoint.sh

RUN sudo chown -R www-data:www-data /var/www/html

EXPOSE 80